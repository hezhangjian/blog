[{"title":"Palantir FoundryæŠ€æœ¯æ¼”è¿›ï¼šä»å®šåˆ¶ä»£ç åˆ°AIPæ™ºèƒ½å†³ç­–","url":"/2025/10/10/Palantir%20Foundry%E6%8A%80%E6%9C%AF%E6%BC%94%E8%BF%9B%EF%BC%9A%E4%BB%8E%E5%AE%9A%E5%88%B6%E4%BB%A3%E7%A0%81%E5%88%B0AIP%E6%99%BA%E8%83%BD%E5%86%B3%E7%AD%96/","content":"TLDRç¬”è€…æ¨æµ‹Palantirèµ·åˆä»¥æ”¯æŒå®šåˆ¶ä»£ç è¿è¡Œä¸ºåŸºç¡€ï¼Œåœ¨æ„ç­‘è‡ªå·±éƒ¨ç½²å¹³å°ï¼ˆApolloï¼ŒPalantir GitHubä¸Šä¹Ÿæœ‰å¾ˆå¤šå¼€å‘è€…æ„å»ºã€Lintå·¥å…·ï¼‰çš„åŒæ—¶ï¼Œé€æ¸æŠ½è±¡å‡ºDatasetã€æœ¬ä½“ã€Functionã€Action APIï¼Œæ‰“é€ äº†åšå®çš„Foundryå¹³å°ï¼Œè®©åº”ç”¨ä»å®šåˆ¶åŒ–å¼€å‘é€æ­¥â€œé•¿åœ¨å¹³å°ä¸Šâ€ã€‚æœ€ç»ˆï¼ŒPalantir æ¨å‡ºäººå·¥æ™ºèƒ½å¹³å°ï¼ˆAIPï¼‰ï¼Œå®ç°æ•°æ®é©±åŠ¨çš„æ™ºèƒ½å†³ç­–ã€‚\nå‰è¨€è¿‘å¹´æ¥ï¼ŒPalantir æ— ç–‘æˆä¸ºæ•°æ®åˆ†æé¢†åŸŸçš„ç„¦ç‚¹ä¹‹ä¸€ã€‚ä½œä¸ºä¸€å®¶ä»¥è§£å†³å¤æ‚é—®é¢˜ä¸ºæ ¸å¿ƒçš„å…¬å¸ï¼ŒPalantir ä¸ºæ”¿åºœã€å›½é˜²å’Œä¼ä¸šå®¢æˆ·æä¾›äº†å¼ºå¤§çš„æ•°æ®æ•´åˆä¸åˆ†æèƒ½åŠ›ã€‚Palantir çš„æ ¸å¿ƒäº§å“ Foundry æ˜¯ä¸€ä¸ªé¢å‘æ•°æ®æ•´åˆä¸åˆ†æçš„å¹³å°ï¼Œå®ƒå¦‚ä½•ä»æœ€åˆçš„å®šåˆ¶åŒ–å¼€å‘é€æ¸æ¼”å˜ä¸ºå¦‚ä»Šçš„é€šç”¨æ•°æ®æ™ºèƒ½å¹³å°ï¼Ÿç¬”è€…å°è¯•åŸºäºå…¬å¼€èµ„æºæ¨æµ‹æ¢³ç† Palantir FoundryæŠ€æœ¯å¹³å°çš„æ¼”è¿›è·¯çº¿ï¼Œåˆ†äº«ä¸€äº›åˆ†æä¸æ¨æµ‹ã€‚æœ¬æ–‡ä»…ä»£è¡¨ä¸ªäººè§‚ç‚¹ï¼Œæ¬¢è¿è¯»è€…äº¤æµæ¢è®¨ã€‚\né˜¶æ®µ0 å®šåˆ¶ä»£ç è¿è¡Œä»Palantirçš„Offeringæ¥çœ‹ï¼Œå…¶æ ¸å¿ƒå§‹ç»ˆæ˜¯ä¸ºå®¢æˆ·è§£å†³å¤æ‚é—®é¢˜ï¼Œæ‹¥æœ‰å¤§é‡çš„FDEã€‚åˆç†æ¨æµ‹Palantiræœ€æ—©å…¶å®ä»¥å®šåˆ¶ä»£ç è¿è¡Œäº¤ä»˜ä½œä¸ºåŸºç¡€ï¼Œé€šè¿‡é«˜åº¦å®šåˆ¶åŒ–çš„è½¯ä»¶å¼€å‘æ»¡è¶³å®¢æˆ·åœ¨æ”¿åºœã€å›½é˜²å’Œä¼ä¸šé¢†åŸŸçš„ç‰¹å®šéœ€æ±‚ã€‚é˜¶æ®µ0ï¼Œæ­¤æ—¶éƒ½å¤„äºå®šåˆ¶å¼€å‘çŠ¶æ€ã€‚\né˜¶æ®µ1 ä»å®šåˆ¶ä»£ç è¿è¡Œåˆ°Palantirå¹³å°è¿è¡Œæ­£å¦‚ã€Šäººæœˆç¥è¯ã€‹ä¸­æ‰€è¯´ï¼Œä¼˜ç§€çš„ç¨‹åºå‘˜éƒ½ä¼šæœ‰è‡ªå·±çš„libraryåº“ï¼Œä¼˜ç§€çš„å®šåˆ¶å¼€å‘å•†ä¹Ÿå€¾å‘äºæç‚¼å¯å¤ç”¨çš„æŠ€æœ¯æ¡†æ¶ã€‚\nå¯¹äºå®šåˆ¶ä»£ç æ¥è¯´ï¼Œæˆ‘ä»¬æŠŠå®šåˆ¶ä»£ç åˆ†ä¸ºç¼–å†™æ€å’Œè¿è¡Œæ€\n\nç¼–å†™æ€ï¼Œå¯¹åº”Palantir Code Repositoriesï¼Œå¯ä»¥çœ‹åˆ°Palantirçš„å¾ˆå¤šä¸œè¥¿ï¼Œå…¶å®è·ŸGitå¾ˆç›¸ä¼¼ï¼Œæœ‰åˆ†æ”¯ã€åˆå¹¶ç­‰ç­‰ã€‚\nè¿è¡Œæ€ï¼Œå°†Palantir Code Repositoriesçš„ä»£ç æ„å»ºè¿è¡Œï¼Œæ”¯æŒå¤šç§è§¦å‘æ–¹å¼ï¼Œæ¯”å¦‚é€šè¿‡APIè°ƒç”¨æ¥æ‰§è¡Œï¼Œå®šæ—¶æ‰§è¡Œç­‰ã€‚Apollo å¹³å°è¿›ä¸€æ­¥æ”¯æŒå¤šç¯å¢ƒéƒ¨ç½²ï¼ˆå¦‚äº‘å’Œè¾¹ç¼˜ï¼‰ã€‚\n\né˜¶æ®µ2 æ•°æ®çš„å¹³å°åŒ–å­˜å‚¨å’Œç®¡ç†å½“å¼€å‘å·¥ä½œé€æ¸è¿ç§»åˆ° Palantir å¹³å°åï¼Œæ•°æ®çš„å­˜å‚¨å’Œç®¡ç†æˆä¸ºä¸‹ä¸€ä¸ªé‡ç‚¹ã€‚å¦‚æœä»£ç å·²ç»è¿è¡Œåœ¨å¹³å°ä¸Šï¼Œé‚£ä¹ˆæ•°æ®ä¸ºä»€ä¹ˆä¸èƒ½ä¹Ÿå­˜å‚¨åœ¨å¹³å°ä¸­å‘¢ï¼Ÿ\nPalantir åœ¨è¿™ä¸€é˜¶æ®µå¼•å…¥äº† Dataset å’Œæœ¬ä½“ï¼ˆOntologyï¼‰æ¨¡å‹ï¼Œæ„å»ºäº†å¹³å°åŒ–çš„æ•°æ®ç®¡ç†èƒ½åŠ›ã€‚Dataset ä½œä¸ºæ•°æ®çš„æ ¸å¿ƒå®¹å™¨ï¼Œæ”¯æŒç»“æ„åŒ–å’Œéç»“æ„åŒ–æ•°æ®çš„å­˜å‚¨ï¼›æœ¬ä½“åˆ™å®šä¹‰äº†æ•°æ®ä¹‹é—´çš„è¯­ä¹‰å…³ç³»ï¼Œä¸ºæ•°æ®æä¾›äº†æ›´é«˜çº§çš„æŠ½è±¡å±‚ã€‚æ­¤å¤–ï¼ŒPalantir æ¥å…¥äº†æ—¶åºæ•°æ®åº“ï¼Œå¢åŠ äº†å¯¹æ—¶é—´åºåˆ—æ•°æ®çš„æ”¯æŒï¼Œæ»¡è¶³äº†é‡‘èã€å·¥ä¸šç­‰é¢†åŸŸå¯¹å®æ—¶æ•°æ®å¤„ç†çš„éœ€æ±‚ã€‚\nåŒæ—¶ï¼Œä¹ŸæŠŠæ•°æ®é›†çš„å˜æ›´å¢åŠ ä¸ºä¸€ä¸ªè§¦å‘æ¡ä»¶ã€‚ä¾‹å¦‚ï¼Œå½“æŸä¸ª Dataset å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¹³å°å¯ä»¥è‡ªåŠ¨è§¦å‘é¢„å®šä¹‰çš„æ“ä½œï¼Œå¦‚è¿è¡Œä¸€æ®µä»£ç æˆ–æ›´æ–°å…¶ä»–æ•°æ®é›†ã€‚\n\né˜¶æ®µ3 æŠ½è±¡Action Functionåœ¨æœ¬ä½“å·²ç»å®šä¹‰äº†DataSetä»¥åŠæ•°æ®é›†ä¹‹é—´å…³ç³»çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡Actionã€Functionçš„å®šä¹‰ï¼ŒåŒæ—¶Actionã€Functionå¯ä»¥é€šè¿‡æ‹–æ‹‰æ‹½ç®€å•åœ°ç”Ÿæˆï¼Œæ— éœ€ä¹¦å†™ä»£ç ã€‚å¯¹äºéš¾ä»¥æ— ç çš„å¤æ‚é€»è¾‘ï¼Œè¿˜å¯ä»¥é€šè¿‡å®šåˆ¶ä»£ç æ¥ä¹¦å†™ã€‚\nå…¶å®Workflowå’ŒPipelineéƒ½æ˜¯åœ¨æ›´é«˜å±‚æ¬¡ã€æ›´ç®€ä¾¿åœ°æ“ä½œä»£ç çš„æ‰‹æ®µè€Œå­˜åœ¨ï¼Œåº•å±‚å®ç°ä¸Šï¼š\n\nPipeline &#x3D; Datasets+Builds+Schedules\nWorkflow &#x3D; Schedules + Builds + Jobs\n\n\né˜¶æ®µ 4ï¼šAIP çš„æ™ºèƒ½å†³ç­–èµ‹èƒ½åœ¨Foundryåšå®çš„åŸºç¡€ä¸Šï¼ŒPalantir 2023 å¹´æ¨å‡ºäº† AIPï¼ˆäººå·¥æ™ºèƒ½å¹³å°ï¼‰æ•´åˆå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ä¸ Foundry æ•°æ®ï¼Œè‡ªåŠ¨åŒ–å¤æ‚å†³ç­–ã€‚å…¶æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š\n\nè‡ªç„¶è¯­è¨€å¤„ç†ï¼šç”¨æˆ·é€šè¿‡å¯¹è¯ç•Œé¢æŸ¥è¯¢æ•°æ®æˆ–ç”Ÿæˆåˆ†æï¼Œå¦‚â€œé¢„æµ‹ä¸‹å­£åº¦åº“å­˜éœ€æ±‚â€ã€‚\nè‡ªåŠ¨åŒ–å·¥ä½œæµï¼šåŸºäº Ontologyï¼ŒAIP é©±åŠ¨æ™ºèƒ½å†³ç­–ï¼Œä¾‹å¦‚ä¼˜åŒ–ä¾›åº”é“¾æˆ–è°ƒåº¦èµ„æºã€‚\nå®æ—¶æ¨ç†ï¼šç»“åˆæ—¶åºæ•°æ®ï¼ŒAIP æ”¯æŒåŠ¨æ€é¢„æµ‹ï¼Œå¦‚åŒ»ç–—èµ„æºåˆ†é…æˆ–å·¥ä¸šæ•…éšœæ£€æµ‹ã€‚\n\næ€»ç»“å›¾ï¼šç¬”è€…è®¾æƒ³çš„ä¼ä¸šä½¿ç”¨Foundryè·¯çº¿å›¾\næœ¬æ–‡åˆ†æäº†Palantir Foundryçš„æŠ€æœ¯å®ç°è·¯å¾„ï¼Œç¬”è€…è®¤ä¸ºPalantir Foundry çš„æŠ€æœ¯æ¼”è¿›å±•ç°äº†ä¸€ä¸ªä»â€œå®šåˆ¶â€åˆ°â€œå¹³å°åŸç”Ÿâ€çš„æ¸…æ™°è·¯å¾„ã€‚åº”ç”¨ä»åˆ†æ•£çš„å®šåˆ¶ä»£ç ï¼Œé€æ­¥è¿ç§»åˆ°å¹³å°ä¸Šè¿è¡Œï¼Œæ‰æ ¹äºå¹³å°çš„æ•°æ®å’Œè§¦å‘æœºåˆ¶ï¼Œæœ€ç»ˆæˆä¸ºå®Œå…¨ä¾èµ–å¹³å°åŠŸèƒ½çš„åŸç”Ÿåº”ç”¨ã€‚\n","tags":["Palantir"]},{"title":"Calcite Parserä»£ç ç”Ÿæˆè¯¦è§£","url":"/2022/09/26/Calcite%20Parser%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E8%AF%A6%E8%A7%A3/","content":"æœ¬æ–‡ä»£ç å‡å·²ä¸Šä¼ åˆ°giteecalciteçš„parserä»£ç ç”Ÿæˆåˆ†ä¸ºå¦‚ä¸‹ä¸¤ä¸ªæ­¥éª¤  \n  \nç”ŸæˆParse.jjæ–‡ä»¶ç›®å½•å¦‚ä¸‹\nâ”œâ”€â”€ pom.xmlâ””â”€â”€ src    â”œâ”€â”€ main    â”‚Â Â  â”œâ”€â”€ codegen    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ config.fmpp    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ includes    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ compoundIdentifier.ftl    â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ parserImpls.ftl    â”‚Â Â  â”‚Â Â  â””â”€â”€ templates    â”‚Â Â  â”‚Â Â      â””â”€â”€ Parser.jj\n\næ·»åŠ calcite dependency\n&lt;dependency&gt;    &lt;groupId&gt;org.apache.calcite&lt;/groupId&gt;    &lt;artifactId&gt;calcite-core&lt;/artifactId&gt;&lt;/dependency&gt;\n\n\n\né…ç½®drill-fmpp-maven-pluginæ’ä»¶å¦‚ä¸‹\n&lt;plugin&gt;    &lt;groupId&gt;org.apache.drill.tools&lt;/groupId&gt;    &lt;artifactId&gt;drill-fmpp-maven-plugin&lt;/artifactId&gt;    &lt;executions&gt;        &lt;execution&gt;            &lt;configuration&gt;                &lt;config&gt;src/main/codegen/config.fmpp&lt;/config&gt;                &lt;output&gt;$&#123;project.build.directory&#125;/generated-sources/fmpp&lt;/output&gt;                &lt;templates&gt;src/main/codegen/templates&lt;/templates&gt;            &lt;/configuration&gt;            &lt;id&gt;generate-fmpp-sources&lt;/id&gt;            &lt;phase&gt;validate&lt;/phase&gt;            &lt;goals&gt;                &lt;goal&gt;generate&lt;/goal&gt;            &lt;/goals&gt;        &lt;/execution&gt;    &lt;/executions&gt;&lt;/plugin&gt;\n\ncodegen æ¨¡å—çš„æ–‡ä»¶éƒ½æ‹·è´è‡ªå¯¹åº”ç‰ˆæœ¬çš„calclite core&#x2F;src&#x2F;main&#x2F;codegenè·¯å¾„ https://github.com/apache/calcite/tree/main/core/src/main/codegen\nç„¶åæŠŠhttps://github.com/apache/calcite/blob/main/core/src/main/codegen/default_config.fmpp ä¸­çš„parserå±æ€§ä¸config.fmppä¸­çš„parserå±æ€§åˆå¹¶ã€‚å°±å¯ä»¥é€šè¿‡mvn packageå‘½ä»¤ç”ŸæˆParser.jjäº†ã€‚å½“ç„¶ï¼Œå¦‚æœæœ‰å®šåˆ¶åŒ–ä¿®æ”¹çš„éœ€æ±‚ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™ä¸ªé˜¶æ®µä¿®æ”¹config.fmpp  \n  \nParser.jjç”Ÿæˆjavaä»£ç æ–‡ä»¶ç›®å½•å¦‚ä¸‹\nâ”œâ”€â”€ pom.xmlâ”œâ”€â”€ srcâ”‚Â Â  â”œâ”€â”€ mainâ”‚Â Â  â”‚Â Â  â”œâ”€â”€ codegenâ”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ Parser.jj\n\nParser.jjå°±æ˜¯æˆ‘ä»¬ä¸Šä¸€æ­¥ç”Ÿæˆçš„Parser.jjï¼Œå¦‚æœæœ‰ä»€ä¹ˆæƒ³è¦çš„å®šåˆ¶åŒ–ä¿®æ”¹ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™ä¸ªæ­¥éª¤æ”¹å…¥åˆ°Parser.jjä¸­ã€‚\næ·»åŠ calcite dependency\n&lt;dependency&gt;    &lt;groupId&gt;org.apache.calcite&lt;/groupId&gt;    &lt;artifactId&gt;calcite-core&lt;/artifactId&gt;&lt;/dependency&gt;\n\né…ç½®javacc-maven-pluginå¦‚ä¸‹\n&lt;plugin&gt;    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;    &lt;artifactId&gt;javacc-maven-plugin&lt;/artifactId&gt;    &lt;executions&gt;        &lt;execution&gt;            &lt;id&gt;javacc&lt;/id&gt;            &lt;goals&gt;                &lt;goal&gt;javacc&lt;/goal&gt;            &lt;/goals&gt;            &lt;configuration&gt;                &lt;sourceDirectory&gt;$&#123;project.basedir&#125;/src/main/codegen&lt;/sourceDirectory&gt;                &lt;includes&gt;                    &lt;include&gt;**/Parser.jj&lt;/include&gt;                &lt;/includes&gt;            &lt;/configuration&gt;        &lt;/execution&gt;    &lt;/executions&gt;&lt;/plugin&gt;\n\nç”Ÿæˆä»£ç   \n  \næ— Parser.jjå®šåˆ¶åŒ–ä¿®æ”¹ï¼Œä¸€æ­¥ç”Ÿæˆæ— Parser.jjå®šåˆ¶åŒ–ä¿®æ”¹ï¼Œä¸€æ­¥ç”Ÿæˆå¦‚æœä¸éœ€è¦å¯¹Parser.jjè¿›è¡Œå®šåˆ¶åŒ–ä¿®æ”¹ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡è¿ç»­è¿è¡Œä¸¤ä¸ªæ’ä»¶æ¥ç”Ÿæˆä»£ç ï¼Œè¿™é‡Œç»™å‡ºpomæ–‡ä»¶æ ·ä¾‹ï¼Œä¸å†èµ˜è¿°\n&lt;plugin&gt;    &lt;groupId&gt;org.apache.drill.tools&lt;/groupId&gt;    &lt;artifactId&gt;drill-fmpp-maven-plugin&lt;/artifactId&gt;    &lt;executions&gt;        &lt;execution&gt;            &lt;configuration&gt;                &lt;config&gt;src/main/codegen/config.fmpp&lt;/config&gt;                &lt;output&gt;$&#123;project.build.directory&#125;/generated-sources/fmpp&lt;/output&gt;                &lt;templates&gt;src/main/codegen/templates&lt;/templates&gt;            &lt;/configuration&gt;            &lt;id&gt;generate-fmpp-sources&lt;/id&gt;            &lt;phase&gt;validate&lt;/phase&gt;            &lt;goals&gt;                &lt;goal&gt;generate&lt;/goal&gt;            &lt;/goals&gt;        &lt;/execution&gt;    &lt;/executions&gt;&lt;/plugin&gt;&lt;plugin&gt;    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;    &lt;artifactId&gt;javacc-maven-plugin&lt;/artifactId&gt;    &lt;executions&gt;        &lt;execution&gt;            &lt;id&gt;javacc&lt;/id&gt;            &lt;goals&gt;                &lt;goal&gt;javacc&lt;/goal&gt;            &lt;/goals&gt;            &lt;configuration&gt;                &lt;sourceDirectory&gt;$&#123;project.build.directory&#125;/generated-sources/fmpp&lt;/sourceDirectory&gt;                &lt;includes&gt;                    &lt;include&gt;**/Parser.jj&lt;/include&gt;                &lt;/includes&gt;                &lt;lookAhead&gt;2&lt;/lookAhead&gt;                &lt;isStatic&gt;false&lt;/isStatic&gt;            &lt;/configuration&gt;        &lt;/execution&gt;        &lt;execution&gt;            &lt;id&gt;javacc-test&lt;/id&gt;            &lt;phase&gt;generate-test-sources&lt;/phase&gt;            &lt;goals&gt;                &lt;goal&gt;javacc&lt;/goal&gt;            &lt;/goals&gt;            &lt;configuration&gt;                &lt;sourceDirectory&gt;$&#123;project.build.directory&#125;/generated-test-sources/fmpp&lt;/sourceDirectory&gt;                &lt;outputDirectory&gt;$&#123;project.build.directory&#125;/generated-test-sources/javacc&lt;/outputDirectory&gt;                &lt;includes&gt;                    &lt;include&gt;**/Parser.jj&lt;/include&gt;                &lt;/includes&gt;                &lt;isStatic&gt;false&lt;/isStatic&gt;                &lt;ignoreCase&gt;true&lt;/ignoreCase&gt;                &lt;unicodeInput&gt;true&lt;/unicodeInput&gt;            &lt;/configuration&gt;        &lt;/execution&gt;    &lt;/executions&gt;&lt;/plugin&gt;\n"},{"title":"Java DefaultUncaughtExceptionHandler è¯¦è§£","url":"/2023/06/15/java%20DefaultUncaughtExceptionHandler%20%E8%AF%A6%E8%A7%A3/","content":"åœ¨Javaç¨‹åºè¿è¡Œæ—¶ï¼Œä¸€äº›éå—æ£€å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œæ¯”å¦‚NullPointerExceptionã€ArrayIndexOutOfBoundsExceptionç­‰ç­‰ï¼Œè¿™äº›å¼‚å¸¸éƒ½æ˜¯ç”±JVMæŠ›å‡ºçš„ï¼Œå¦‚æœä¸å¯¹è¿™äº›å¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œå°åˆ™çº¿ç¨‹è¿è¡Œä¸­çªç„¶é€€å‡ºï¼Œå¤§åˆ™æ•´ä¸ªç¨‹åºå´©æºƒã€‚ç†æƒ³çš„åœºæ™¯ä¸‹ï¼Œæ¯ä¸€ä¸ªéå—æ£€å¼‚å¸¸éƒ½åº”è¯¥è¢«æ•è·å¹¶è¿›è¡Œå¤„ç†ï¼Œä½†æ˜¯åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šå¿½ç•¥ä¸€äº›å¼‚å¸¸ï¼Œè¿™äº›å¼‚å¸¸å¯èƒ½æ˜¯ç”±äºç¨‹åºå‘˜çš„ç–å¿½å¯¼è‡´çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ç”±äºç¨‹åºå‘˜æ— æ³•é¢„çŸ¥çš„åŸå› å¯¼è‡´çš„ï¼Œæ¯”å¦‚ç¬¬ä¸‰æ–¹åº“æŠ›å‡ºçš„å¼‚å¸¸ã€‚\nä¸ºäº†é¿å…è¿™äº›å¼‚å¸¸å¯¼è‡´ç¨‹åºå´©æºƒï¼ŒJavaæä¾›äº†ä¸€ä¸ªå…¨å±€çš„å¼‚å¸¸å¤„ç†å™¨ï¼Œå³DefaultUncaughtExceptionHandlerï¼Œå®ƒå¯ä»¥æ•è·æ‰€æœ‰æœªè¢«æ•è·çš„å¼‚å¸¸ï¼Œä»è€Œé¿å…ç¨‹åºå´©æºƒã€‚\nDefaultUncaughtçš„ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š\npublic class UncaughtExceptionHandle &#123;    public static void main(String[] args) &#123;        Thread.setDefaultUncaughtExceptionHandler((t, e) -&gt; log.error(&quot;Uncaught exception: &quot;, e));    &#125;&#125;\n\nä¸Šè¿°çš„ä»£ç ä¼šå°†æœªæ•è·çš„å¼‚å¸¸æ‰“å°åˆ°æ—¥å¿—ä¸­ï¼Œå¦‚æœä½ å¸Œæœ›æ‰“å°è‡³æ ‡å‡†è¾“å‡ºæˆ–æ ‡å‡†è¾“å‡ºï¼Œå¯ä»¥å°†logæ›¿æ¢ä¸ºï¼š\n// æ ‡å‡†è¾“å‡ºSystem.out.println(&quot;Uncaught exception: &quot; + e);// é”™è¯¯è¾“å‡ºSystem.err.println(&quot;Uncaught exception: &quot; + e);\n","tags":["Java"]},{"title":"jetty servletçš„ä»£ç å­—ç¬¦é›†é€‰æ‹©","url":"/2023/06/02/jetty%20servlet%E7%9A%84%E7%BC%96%E7%A0%81%E5%AD%97%E7%AC%A6%E9%9B%86%E9%80%89%E6%8B%A9/","content":"è®°ä¸€æ¬¡ä¸­æ–‡æŒ‡æ ‡ä¹±ç é—®é¢˜ï¼Œé—®é¢˜ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\nä»metricbeatå¼€å§‹æ‰¾åŸå› ï¼Œå‘ç°å…¶å®åªè¦æ˜¯UTF-8çš„ç¼–ç æ ¼å¼å°±éƒ½å¯ä»¥è§£æï¼Œæœ€ç»ˆå‘ç°æ˜¯webServerè¿”å›çš„æ•°æ®éUTF-8æ ¼å¼ï¼Œä¿®æ”¹æ–¹æ¡ˆä¹Ÿå¾ˆç®€å•ã€‚å°†servletä¸­çš„content-typeé‡Œé¢çš„text&#x2F;plainä¿®æ”¹æˆtext&#x2F;plain; charset&#x3D;utf-8å°±å¯ä»¥äº†ï¼Œå¦‚ä¸‹é¢ä»£ç æ‰€ç¤º:\nprotected void doGet(HttpServletRequest request, HttpServletResponse response)        throws IOException &#123;    response.setContentType(&quot;text/plain&quot;);    response.setStatus(HttpServletResponse.SC_OK);    response.getWriter().write(&quot;&lt;h1&gt;å“ˆå“ˆ&lt;/h1&gt;&quot;);&#125;\n\næˆ‘ä»¬å¯ä»¥è½»æ˜“ä½¿ç”¨ä¸€ä¸ªdemoæ¥å¤ç°è¿™ä¸ªé—®é¢˜ï¼Œåœ¨mavenä¸­æ·»åŠ å¦‚ä¸‹ä¾èµ–\n&lt;dependency&gt;    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;    &lt;artifactId&gt;jetty-server&lt;/artifactId&gt;    &lt;version&gt;9.4.35.v20201120&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt;    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;    &lt;artifactId&gt;jetty-servlet&lt;/artifactId&gt;    &lt;version&gt;9.4.35.v20201120&lt;/version&gt;&lt;/dependency&gt;\n\npackage com.shoothzj.jetty;import org.eclipse.jetty.server.Server;import org.eclipse.jetty.servlet.ServletContextHandler;import org.eclipse.jetty.servlet.ServletHolder;import javax.servlet.http.HttpServlet;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;public class SimpleJettyServer &#123;    public static void main(String[] args) throws Exception &#123;        Server server = new Server(8080);        ServletContextHandler context = new ServletContextHandler(ServletContextHandler.SESSIONS);        context.setContextPath(&quot;/&quot;);        server.setHandler(context);        context.addServlet(new ServletHolder(new HelloDefaultServlet()), &quot;/hello-default&quot;);        context.addServlet(new ServletHolder(new HelloUTF8Servlet()), &quot;/hello-utf8&quot;);        server.start();        server.join();    &#125;    public static class HelloDefaultServlet extends HttpServlet &#123;        @Override        protected void doGet(HttpServletRequest request, HttpServletResponse response)                throws IOException &#123;            response.setContentType(&quot;text/plain&quot;);            response.setStatus(HttpServletResponse.SC_OK);            response.getWriter().write(&quot;&lt;h1&gt;å“ˆå“ˆ&lt;/h1&gt;&quot;);        &#125;    &#125;    public static class HelloUTF8Servlet extends HttpServlet &#123;        @Override        protected void doGet(HttpServletRequest request, HttpServletResponse response)                throws IOException &#123;            response.setContentType(&quot;text/plain; charset=UTF-8&quot;);            response.setStatus(HttpServletResponse.SC_OK);            response.getWriter().write(&quot;&lt;h1&gt;å“ˆå“ˆ&lt;/h1&gt;&quot;);        &#125;    &#125;&#125;\n\né€šè¿‡curlå‘½ä»¤æ¥å¤ç°è¿™ä¸ªé—®é¢˜\ncurl localhost:8080/hello-default&lt;h1&gt;??&lt;/h1&gt;%curl localhost:8080/hello-utf8&lt;h1&gt;å“ˆå“ˆ&lt;/h1&gt;%\n\né‚£ä¹ˆservleté‡Œé¢çš„æ•°æ®å¦‚ä½•ç¼–ç ï¼Œæˆ‘ä»¬å¯ä»¥diveä¸€ä¸‹ï¼Œé¦–å…ˆservleté‡Œé¢æœ‰ä¸€ä¸ªå‡½æ•°å«**response.setCharacterEncoding();**è¿™ä¸ªå‡½æ•°å¯ä»¥æŒ‡å®šç¼–ç æ ¼å¼ã€‚å…¶æ¬¡ï¼Œservletè¿˜ä¼šé€šè¿‡ä¸Šé¢çš„setContentTypeå‡½æ•°æ¥åšä¸€å®šçš„æ¨æ–­ï¼Œæ¯”å¦‚content-typeä¸­æºå¸¦äº†charsetï¼Œå°±ä½¿ç”¨content-typeä¸­çš„charsetã€‚è¿˜æœ‰äº›ç‰¹å®šçš„content-typeï¼Œæ¯”å¦‚text&#x2F;jsonï¼Œåœ¨æ²¡æœ‰è®¾ç½®çš„æƒ…å†µä¸‹ï¼Œservletå®¹å™¨ä¼šå‡è®¾å®ƒä½¿ç”¨utf-8ç¼–ç ã€‚åœ¨æ¨æ–­ä¸å‡ºæ¥ï¼Œä¹Ÿæ²¡æœ‰æ‰‹åŠ¨è®¾ç½®çš„æƒ…å†µä¸‹ï¼Œjettyé»˜è®¤çš„ç¼–ç æ˜¯iso-8859-1ï¼Œè¿™å°±è§£é‡Šäº†ä¹±ç çš„é—®é¢˜ã€‚\n"},{"title":"prometheus tsdbç´¢å¼•å¸ƒå±€åŠæŸ¥è¯¢æµç¨‹","url":"/2022/07/18/prometheus%20tsdb%E7%B4%A2%E5%BC%95%E5%B8%83%E5%B1%80%E5%8F%8A%E6%9F%A5%E8%AF%A2%E6%B5%81%E7%A8%8B/","content":"prometheus ç£ç›˜å¸ƒå±€é‡‡é›†åˆ°çš„æ•°æ®æ¯ä¸¤ä¸ªå°æ—¶å½¢æˆä¸€ä¸ªblockã€‚æ¯ä¸ªblockç”±ä¸€ä¸ªç›®å½•ç»„æˆï¼Œå¹¶å­˜æ”¾åœ¨dataè·¯å¾„ä¸‹ã€‚è¯¥ç›®å½•åŒ…å«ä¸€ä¸ªåŒ…å«è¯¥æ—¶é—´çª—å£çš„æ‰€æœ‰æ—¶é—´åºåˆ—æ ·æœ¬çš„å—å­ç›®å½•ã€ä¸€ä¸ªå…ƒæ•°æ®æ–‡ä»¶å’Œä¸€ä¸ªç´¢å¼•æ–‡ä»¶ï¼ˆå°†metric_nameå’Œlabelç´¢å¼•åˆ°ç›®å½•ä¸‹çš„æ—¶é—´åºåˆ—ï¼‰ã€‚ chunks ç›®å½•ä¸­çš„æ ·æœ¬é»˜è®¤ç»„åˆæˆä¸€ä¸ªæˆ–å¤šä¸ªæ®µæ–‡ä»¶ï¼Œæ¯ä¸ªæ®µæ–‡ä»¶æœ€å¤§ä¸º 512MBã€‚ å½“é€šè¿‡ API åˆ é™¤ç³»åˆ—æ—¶ï¼Œåˆ é™¤è®°å½•å­˜å‚¨åœ¨å•ç‹¬çš„ tombstone æ–‡ä»¶ä¸­ï¼ˆè€Œä¸æ˜¯ç«‹å³ä»å—æ®µä¸­åˆ é™¤æ•°æ®ï¼‰ã€‚\nå½“å‰æ­£åœ¨å†™å…¥çš„å—ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œæ²¡æœ‰å®Œå…¨æŒä¹…åŒ–ã€‚é€šè¿‡WALæ—¥å¿—æ¥é˜²æ­¢å´©æºƒä¸¢å¤±æ•°æ®ã€‚é¢„å†™æ—¥å¿—åˆ†ä¸ºæ•°èŠ‚(segments)ä¿å­˜åœ¨walæ–‡ä»¶å¤¹ä¸­ã€‚è¿™äº›æ–‡ä»¶åŒ…å«å°šæœªå‹ç¼©çš„åŸå§‹æ•°æ®ï¼› å› æ­¤å®ƒä»¬æ¯”å¸¸è§„å—æ–‡ä»¶å¤§å¾—å¤šã€‚ Prometheus å°†è‡³å°‘ä¿ç•™ä¸‰ä¸ªé¢„å†™æ—¥å¿—æ–‡ä»¶ã€‚åœ¨é«˜æµé‡ä¸‹ï¼Œä¼šä¿ç•™ä¸‰ä¸ªä»¥ä¸Šçš„ WAL æ–‡ä»¶ï¼Œä»¥ä¾¿ä¿ç•™è‡³å°‘ä¸¤ä¸ªå°æ—¶çš„åŸå§‹æ•°æ®ã€‚\n./dataâ”œâ”€â”€ 01BKGV7JBM69T2G1BGBGM6KB12â”‚   â””â”€â”€ meta.jsonâ”œâ”€â”€ 01BKGTZQ1SYQJTR4PB43C8PD98â”‚   â”œâ”€â”€ chunksâ”‚   â”‚   â””â”€â”€ 000001â”‚   â”œâ”€â”€ tombstonesâ”‚   â”œâ”€â”€ indexâ”‚   â””â”€â”€ meta.jsonâ”œâ”€â”€ 01BKGTZQ1HHWHV8FBJXW1Y3W0Kâ”‚   â””â”€â”€ meta.jsonâ”œâ”€â”€ 01BKGV7JC0RY8A6MACW02A2PJDâ”‚   â”œâ”€â”€ chunksâ”‚   â”‚   â””â”€â”€ 000001â”‚   â”œâ”€â”€ tombstonesâ”‚   â”œâ”€â”€ indexâ”‚   â””â”€â”€ meta.jsonâ”œâ”€â”€ chunks_headâ”‚   â””â”€â”€ 000001â””â”€â”€ wal    â”œâ”€â”€ 000000002    â””â”€â”€ checkpoint.00000001        â””â”€â”€ 00000000\n\nprometheusæ¦‚å¿µ\nLabel: æ ‡ç­¾ï¼Œstringæ ¼å¼çš„kvç»„åˆ\nseries: æ—¶é—´åºåˆ—ï¼Œlabelçš„ç»„åˆ\nchunk: æ—¶é—´ï¼Œvalueçš„æ•°æ®\n\nprometheusç´¢å¼•æ ¼å¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ magic(0xBAAAD700) &lt;4b&gt;     â”‚ version(1) &lt;1 byte&gt; â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚                 Symbol Table                 â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚                    Series                    â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚                   Postings 1                 â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚                      ...                     â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚                   Postings N                 â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚             Postings Offset Table            â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚                      TOC                     â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nå†™å…¥ç´¢å¼•æ—¶ï¼Œå¯ä»¥åœ¨ä¸Šé¢åˆ—å‡ºçš„ä¸»è¦éƒ¨åˆ†ä¹‹é—´æ·»åŠ ä»»æ„æ•°é‡çš„0å­—èŠ‚ä½œä¸ºå¡«å……ã€‚é¡ºåºæ‰«ææ–‡ä»¶æ—¶ï¼Œå¿…é¡»è·³è¿‡éƒ¨åˆ†é—´çš„ä»»æ„0å­—èŠ‚ã€‚\nä¸‹é¢æè¿°çš„å¤§éƒ¨åˆ†éƒ¨åˆ†éƒ½ä»¥ len å­—æ®µå¼€å¤´ã€‚ å®ƒæ€»æ˜¯æŒ‡å®šå°±åœ¨å°¾éš CRC32 æ ¡éªŒå’Œä¹‹å‰çš„å­—èŠ‚æ•°ã€‚ æ ¡éªŒå’Œå°±è®¡ç®—è¿™äº›å­—èŠ‚çš„æ ¡éªŒå’Œï¼ˆä¸åŒ…å«lenå­—æ®µï¼‰\nç¬¦å·è¡¨ç¬¦å·è¡¨åŒ…å«å·²å­˜å‚¨åºåˆ—çš„æ ‡ç­¾å¯¹ä¸­å‡ºç°çš„é‡å¤æ•°æ®åˆ é™¤å­—ç¬¦ä¸²çš„æ’åºåˆ—è¡¨ã€‚ å®ƒä»¬å¯ä»¥ä»åç»­éƒ¨åˆ†ä¸­å¼•ç”¨ï¼Œå¹¶æ˜¾ç€å‡å°‘æ€»ç´¢å¼•å¤§å°ã€‚\nè¯¥éƒ¨åˆ†åŒ…å«ä¸€ç³»åˆ—å­—ç¬¦ä¸²entryï¼Œæ¯ä¸ªentryéƒ½ä»¥å­—ç¬¦ä¸²çš„åŸå§‹å­—èŠ‚é•¿åº¦ä¸ºå‰ç¼€ã€‚ æ‰€æœ‰å­—ç¬¦ä¸²å‡é‡‡ç”¨ utf-8 ç¼–ç ã€‚ å­—ç¬¦ä¸²ç”±é¡ºåºç´¢å¼•å¼•ç”¨ã€‚ å­—ç¬¦ä¸²æŒ‰å­—å…¸é¡ºåºå‡åºæ’åºã€‚\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ len &lt;4b&gt;           â”‚ #symbols &lt;4b&gt;       â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ len(str_1) &lt;uvarint&gt; â”‚ str_1 &lt;bytes&gt; â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚                . . .                 â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚ len(str_n) &lt;uvarint&gt; â”‚ str_n &lt;bytes&gt; â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ CRC32 &lt;4b&gt;                               â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\nåºåˆ— seriesä¿å­˜ä¸€ä¸ªå…·ä½“çš„æ—¶é—´åºåˆ—ï¼Œå…¶ä¸­åŒ…å«ç³»åˆ—çš„labelé›†åˆå’Œblockä¸­çš„chunksã€‚\næ¯ä¸ªserieséƒ½æ˜¯16å­—èŠ‚å¯¹é½ã€‚seriesçš„idä¸ºåç§»é‡é™¤ä»¥16ã€‚series ID çš„æ’åºåˆ—è¡¨ä¹Ÿå°±æ˜¯series labelçš„å­—å…¸æ’åºåˆ—è¡¨ã€‚\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚   series_1                        â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚                 . . .             â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚   series_n                        â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\næ¯ä¸€ä¸ªserieså…ˆä¿å­˜labelçš„æ•°é‡ï¼Œç„¶åæ˜¯åŒ…å«labelé”®å€¼å¯¹çš„å¼•ç”¨ã€‚ æ ‡ç­¾å¯¹æŒ‰å­—å…¸é¡ºåºæ’åºã€‚ç„¶åæ˜¯seriesæ¶‰åŠçš„ç´¢å¼•å—çš„ä¸ªæ•°ï¼Œç„¶åæ˜¯ä¸€ç³»åˆ—å…ƒæ•°æ®æ¡ç›®ï¼Œå…¶ä¸­åŒ…å«å—çš„æœ€å° (mint) å’Œæœ€å¤§ (maxt) æ—¶é—´æˆ³ä»¥åŠå¯¹å…¶åœ¨å—æ–‡ä»¶ä¸­ä½ç½®çš„å¼•ç”¨ã€‚mint æ˜¯ç¬¬ä¸€ä¸ªæ ·æœ¬çš„æ—¶é—´ï¼Œmaxt æ˜¯å—ä¸­æœ€åä¸€ä¸ªæ ·æœ¬çš„æ—¶é—´ã€‚ åœ¨ç´¢å¼•ä¸­ä¿å­˜æ—¶é—´èŒƒå›´æ•°æ®, å…è®¸æŒ‰ç…§æ—¶é—´èŒƒå›´åˆ é™¤æ•°æ®æ—¶ï¼Œå¦‚æœæ—¶é—´èŒƒå›´åŒ¹é…ï¼Œä¸éœ€è¦ç›´æ¥è®¿é—®æ—¶é—´æ•°æ®ã€‚\nç©ºé—´å¤§å°ä¼˜åŒ–: ç¬¬ä¸€ä¸ªå—çš„ mint è¢«å­˜å‚¨ï¼Œå®ƒçš„ maxt è¢«å­˜å‚¨ä¸ºä¸€ä¸ªå¢é‡ï¼Œå¹¶ä¸” mint å’Œ maxt è¢«ç¼–ç ä¸ºåç»­å—çš„å‰ä¸€ä¸ªæ—¶é—´çš„å¢é‡ã€‚ ç±»ä¼¼çš„ï¼Œç¬¬ä¸€ä¸ªchunkçš„å¼•ç”¨è¢«å­˜å‚¨ï¼Œä¸‹ä¸€ä¸ªå¼•ç”¨è¢«å­˜å‚¨ä¸ºå‰ä¸€ä¸ªchunkçš„å¢é‡ã€‚\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ len &lt;uvarint&gt;                                                            â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚                     labels count &lt;uvarint64&gt;                         â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ â”‚â”‚ â”‚              â”‚ ref(l_i.name) &lt;uvarint32&gt;                  â”‚          â”‚ â”‚â”‚ â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚ â”‚â”‚ â”‚              â”‚ ref(l_i.value) &lt;uvarint32&gt;                 â”‚          â”‚ â”‚â”‚ â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â”‚â”‚ â”‚                             ...                                      â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚                     chunks count &lt;uvarint64&gt;                         â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ â”‚â”‚ â”‚              â”‚ c_0.mint &lt;varint64&gt;                        â”‚          â”‚ â”‚â”‚ â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚ â”‚â”‚ â”‚              â”‚ c_0.maxt - c_0.mint &lt;uvarint64&gt;            â”‚          â”‚ â”‚â”‚ â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚ â”‚â”‚ â”‚              â”‚ ref(c_0.data) &lt;uvarint64&gt;                  â”‚          â”‚ â”‚â”‚ â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â”‚â”‚ â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ â”‚â”‚ â”‚              â”‚ c_i.mint - c_i-1.maxt &lt;uvarint64&gt;          â”‚          â”‚ â”‚â”‚ â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚ â”‚â”‚ â”‚              â”‚ c_i.maxt - c_i.mint &lt;uvarint64&gt;            â”‚          â”‚ â”‚â”‚ â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚ â”‚â”‚ â”‚              â”‚ ref(c_i.data) - ref(c_i-1.data) &lt;varint64&gt; â”‚          â”‚ â”‚â”‚ â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â”‚â”‚ â”‚                             ...                                      â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ CRC32 &lt;4b&gt;                                                               â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nPostingPostingè¿™ä¸€èŠ‚å­˜æ”¾ç€å…³äºserieså¼•ç”¨çš„å•è°ƒé€’å¢åˆ—è¡¨ï¼Œç®€å•æ¥è¯´å°±æ˜¯å­˜æ”¾idå’Œæ—¶é—´åºåˆ—çš„å¯¹åº”å…³ç³»\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ len &lt;4b&gt;           â”‚ #entries &lt;4b&gt;      â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ ref(series_1) &lt;4b&gt;                  â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚ ...                                 â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚ ref(series_n) &lt;4b&gt;                  â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ CRC32 &lt;4b&gt;                              â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nPosting sectionsçš„é¡ºåºç”±postings offset tableå†³å®šã€‚\nPosting Offset Tablepostings offset tableåŒ…å«ç€ä¸€ç³»åˆ—posting offset entryï¼Œæ ¹æ®labelçš„åç§°å’Œå€¼æ’åºã€‚æ¯ä¸€ä¸ªposting offset entryå­˜æ”¾ç€labelçš„é”®å€¼å¯¹ä»¥åŠåœ¨posting sectionsä¸­å…¶seriesåˆ—è¡¨çš„åç§»é‡ã€‚ç”¨æ¥è·Ÿè¸ªposting sectionsã€‚å½“indexæ–‡ä»¶åŠ è½½æ—¶ï¼Œå®ƒä»¬å°†éƒ¨åˆ†åŠ è½½åˆ°å†…å­˜ä¸­ã€‚\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ len &lt;4b&gt;            â”‚ #entries &lt;4b&gt;        â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚  n = 2 &lt;1b&gt;                            â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚ len(name) &lt;uvarint&gt;  â”‚ name &lt;bytes&gt;    â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚ len(value) &lt;uvarint&gt; â”‚ value &lt;bytes&gt;   â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚  offset &lt;uvarint64&gt;                    â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚                    . . .                   â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚  CRC32 &lt;4b&gt;                                â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nTOCtable of contentsæ˜¯æ•´ä¸ªç´¢å¼•çš„å…¥å£ç‚¹ï¼Œå¹¶æŒ‡å‘æ–‡ä»¶ä¸­çš„å„ä¸ªéƒ¨åˆ†ã€‚ å¦‚æœå¼•ç”¨ä¸ºé›¶ï¼Œåˆ™è¡¨ç¤ºç›¸åº”çš„éƒ¨åˆ†ä¸å­˜åœ¨ï¼ŒæŸ¥æ‰¾æ—¶åº”è¿”å›ç©ºç»“æœã€‚\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ref(symbols) &lt;8b&gt;                       â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ ref(series) &lt;8b&gt;                        â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ ref(label indices start) &lt;8b&gt;           â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ ref(label offset table) &lt;8b&gt;            â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ ref(postings start) &lt;8b&gt;                â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ ref(postings offset table) &lt;8b&gt;         â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ CRC32 &lt;4b&gt;                              â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nchunks ç£ç›˜æ ¼å¼chunksæ–‡ä»¶åˆ›å»ºåœ¨blockä¸­çš„chunks/ç›®å½•ä¸­ã€‚ æ¯ä¸ªæ®µæ–‡ä»¶çš„æœ€å¤§å¤§å°ä¸º 512MBã€‚æ–‡ä»¶ä¸­çš„chunkç”±uint64çš„ç´¢å¼•ç»„ç»‡ï¼Œç´¢å¼•ä½å››ä½ä¸ºæ–‡ä»¶å†…åç§»ï¼Œé«˜å››ä½ä¸ºæ®µåºåˆ—å·ã€‚\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  magic(0x85BD40DD) &lt;4 byte&gt;  â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚    version(1) &lt;1 byte&gt;       â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚    padding(0) &lt;3 byte&gt;       â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚         Chunk 1          â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚          ...             â”‚ â”‚â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚â”‚ â”‚         Chunk N          â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nchunksä¸­çš„Chunkæ ¼å¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ len &lt;uvarint&gt; â”‚ encoding &lt;1 byte&gt; â”‚ data &lt;bytes&gt; â”‚ CRC32 &lt;4 byte&gt; â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\næŸ¥è¯¢æ•°æ®codeæŸ¥è¯¢çš„prometheusæ–¹æ³•ç­¾å\nSelect(sortSeries bool, hints *SelectHints, matchers ...*labels.Matcher) SeriesSet\n\næ”¯æŒä»blockä¸­ï¼Œremoteç­‰å„ç§åœ°æ–¹æŸ¥è¯¢è·å–æ•°æ®\nprometheusä¼šåœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ªæ•°æ®ç»“æ„\n// Map of LabelName to a list of some LabelValues&#x27;s position in the offset table.// The first and last values for each name are always present.postings map[string][]postingOffset\n\nåœ¨å†…å­˜ä¸­ï¼Œä¿ç•™æ¯ä¸ªlabel nameï¼Œå¹¶ä¸”æ¯nä¸ªä¿å­˜labelå€¼ï¼Œé™ä½å†…å­˜çš„å ç”¨ã€‚ä½†æ˜¯ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå€¼æ€»æ˜¯ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚\næŸ¥è¯¢æ•°æ®æµç¨‹\nå‚è€ƒèµ„æ–™\nhttps://prometheus.io/docs/prometheus/latest/storage/\nhttps://github.com/prometheus/prometheus/blob/release-2.37/tsdb/docs/format/README.md\nhttps://github.com/prometheus/prometheus/blob/release-2.37/tsdb/docs/format/index.md\n\n","tags":["Prometheus"]},{"title":"å¾®æœåŠ¡å¹¿æ’­æ¨¡å¼å®è·µ","url":"/2023/06/01/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%B9%BF%E6%92%AD%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5/","content":"å¾®æœåŠ¡å¹¿æ’­æ¨¡å¼ï¼ŒæŒ‡çš„æ˜¯åœ¨å¾®æœåŠ¡å¤šå®ä¾‹éƒ¨ç½²çš„åœºæ™¯ä¸‹ï¼Œå°†æ¶ˆæ¯å¹¿æ’­åˆ°å¤šä¸ªå¾®æœåŠ¡å®ä¾‹çš„ä¸€ç§æ¨¡å¼ã€‚\n\nå¹¿æ’­æ¨¡å¼ï¼Œä¸€èˆ¬ç”¨æ¥ç»´æŠ¤å¾®æœåŠ¡çš„å†…å­˜æ•°æ®ï¼Œæ ¹æ®æ•°æ®ç±»å‹çš„ä¸åŒï¼Œæœ‰åŠ©äºè§£å†³ä¸¤ç±»é—®é¢˜ã€‚é€šå¸¸å¹¿æ’­æ¨¡å¼ä¼šä½¿ç”¨æ”¯æŒå‘å¸ƒè®¢é˜…çš„æ¶ˆæ¯ä¸­é—´ä»¶å®ç°ï¼ˆå¦‚Redisã€Kafkaã€Pulsarç­‰ï¼‰ï¼Œæœ¬æ–‡ä¹ŸåŸºäºæ¶ˆæ¯ä¸­é—´ä»¶è¿›è¡Œè®¨è®ºã€‚\nåˆ©ç”¨å¹¿æ’­æ¨¡å¼ç»´æŠ¤ä¸€è‡´çš„ç¼“å­˜è¿™åº”è¯¥æ˜¯å¹¿æ’­æ¨¡å¼åˆ©ç”¨æœ€å¤šçš„ä¸€ç§åœºæ™¯ï¼Œå‡æƒ³ä¸€ä¸ªæ‹¥æœ‰æµ·é‡ç”¨æˆ·çš„ç”µå•†ç½‘ç«™ã€æˆ–æ˜¯ä¸€ä¸ªäº¿çº§è®¾å¤‡è¿æ¥çš„IoTå¹³å°ã€‚åŠ¿å¿…ä¼šå­˜åœ¨ä¸€äº›ç¼“å­˜æ•°æ®ï¼Œåƒæ˜¯ç”¨æˆ·çš„è´­ç‰©è½¦ä¿¡æ¯ï¼Œæˆ–æ˜¯è®¾å¤‡çš„å¯†é’¥ç¼“å­˜ã€‚å¦‚æœæ²¡æœ‰å¹¿æ’­æ¨¡å¼ï¼Œå¯èƒ½ä¼šå­˜åœ¨è¿™æ ·çš„é—®é¢˜\n\nå½“ç”¨æˆ·æ›´æ–°äº†å®ƒçš„è´­ç‰©è½¦ä¹‹åï¼Œå¾®æœåŠ¡å®ä¾‹1çš„æ•°æ®å‘ç”Ÿäº†æ›´æ–°ï¼Œæ•°æ®åº“çš„æ•°æ®ä¹ŸæˆåŠŸæ›´æ–°ã€‚ä½†æ˜¯å¾®æœåŠ¡å®ä¾‹2ä¸­çš„ç¼“å­˜æ•°æ®æœªèƒ½æ›´æ–°ï¼Œé‚£ä¹ˆå¦‚æœç”¨æˆ·çš„è¯·æ±‚å‡è¡¡åˆ°äº†å®ä¾‹2ï¼Œå°±ä¼šå‘ç”Ÿæ„æƒ³ä¸åˆ°çš„åæœã€‚\nè¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥è®©å¾®æœåŠ¡1åœ¨å¹¿æ’­é€šé“ä¸­å‘é€ä¸€ä¸ªç¼“å­˜çš„invalidateæ¶ˆæ¯ï¼Œå°†å¾®æœåŠ¡å®ä¾‹2ä¸­è¯¥ç”¨æˆ·çš„ç¼“å­˜æ¸…é›¶ï¼Œä½¿å¾—å¾®æœåŠ¡å®ä¾‹2åœ¨ä¸‹ä¸€æ¬¡å¤„ç†è¯¥ç”¨æˆ·çš„è¯·æ±‚æ—¶ï¼Œä»æ•°æ®åº“ä¸­è¯»å–æœ€æ–°çš„æ¶ˆæ¯ã€‚\nä½¿ç”¨è¯¥æ¨¡å¼éœ€è¦æ³¨æ„çš„ç‚¹ï¼š\n\næ¯ä¸ªå¾®æœåŠ¡å®ä¾‹åº”è¯¥ä½¿ç”¨ä¸åŒçš„æ¶ˆè´¹ç»„ï¼Œå¯ä»¥é€šè¿‡å¾®æœåŠ¡çš„IPã€ä¸»æœºåã€UUIDç­‰æ‹¼è£…æˆè®¢é˜…ç»„åç§°ï¼Œè¿™æ‰ç§°å¾—ä¸Šå¹¿æ’­ä¹‹å\nå¾®æœåŠ¡æ¶ˆè´¹æ¶ˆæ¯çš„æ—¶å€™ï¼Œåº”ä»Latestå¼€å§‹æ¶ˆè´¹ï¼Œé¿å…ä»Earliestå¼€å§‹æ¶ˆè´¹æ— ç”¨çš„ç¼“å­˜æ¸…ç†æ¶ˆæ¯\nç”±äºæ¯ä¸€æ¬¡å¾®æœåŠ¡é‡å¯éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„æ¶ˆè´¹ç»„ï¼Œéœ€è¦æ³¨æ„æ¶ˆè´¹ç»„çš„è€åŒ–ï¼Œå¯ä»¥é€šè¿‡æ¶ˆæ¯ä¸­é—´ä»¶è‡ªå¸¦çš„ä¸æ´»è·ƒæ¶ˆè´¹ç»„è€åŒ–èƒ½åŠ›å…œåº•ï¼Œå»ºè®®é€šè¿‡gracefulExitã€ç›‘å¬killä¿¡å·ç­‰æœºåˆ¶æ¥ä¸»åŠ¨åˆ é™¤æ¶ˆè´¹ç»„ä¿¡æ¯\n\nä¸ºä»€ä¹ˆè¯´æ¶ˆè´¹ç»„è€åŒ–æ¯”è¾ƒé‡è¦å‘¢ï¼Œå› ä¸ºå¾ˆå¤šç›‘æ§ç³»ç»Ÿéƒ½ä¼šæ ¹æ®æ¶ˆè´¹ç»„çš„ç§¯å‹æ¥åšå‘Šè­¦ï¼Œå¾ˆå®¹æ˜“äº§ç”Ÿè¯¯å‘Šè­¦ã€‚\nåˆ©ç”¨å¹¿æ’­æ¨¡å¼ç»´æŠ¤å†…å­˜ä¸­çš„æ•°æ®è¿™ç§æ¨¡å¼ç›¸å¯¹æ¯”è¾ƒå°‘è§ï¼Œå¸¸è§äºkeyçš„åŸºæ•°ä¸æ˜¯å¾ˆå¤§ï¼Œèƒ½å¤Ÿå°†æ•°æ®å®Œæ•´åœ°å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œæ¯”å¦‚ç”µå•†å¹³å°çš„ä¼ä¸šå–å®¶ä¸ªæ•°ã€ç‰©è”ç½‘å¹³å°çš„ç”¨æˆ·ä¸ªæ•°ç­‰ï¼Œå¹¶ä¸”å¯¹æ•°æ®çš„ä¸€è‡´æ€§è¦æ±‚ä¸æ˜¯å¾ˆé«˜ï¼ˆå› ä¸ºå¹¿æ’­æ¨¡å¼æƒ…å†µä¸‹ï¼Œå¯¹äºä¸¤ä¸ªå¾®æœåŠ¡å®ä¾‹æ¥è¯´æ²¡æœ‰ä¸€è‡´æ€§ä¿éšœï¼‰ã€‚åƒApache Pulsarè®¾è®¡çš„TableViewï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œå°±æ˜¯åšè¿™ä¸ªäº‹çš„ä¸€ä¸ªæœ€ä½³å®è·µã€‚Pulsarå†…éƒ¨å¤§é‡ä½¿ç”¨äº†topicå­˜å‚¨æ•°æ®ï¼Œå°±æ˜¯é‡‡ç”¨è¿™ä¸ªæ–¹å¼ã€‚\nä½¿ç”¨è¯¥æ¨¡å¼éœ€è¦æ³¨æ„çš„ç‚¹ï¼š\n\nåŒä¸Šï¼Œéœ€è¦ä½¿ç”¨ä¸åŒçš„æ¶ˆè´¹ç»„åç§°\nå¾®æœåŠ¡æ¶ˆè´¹æ¶ˆæ¯çš„æ—¶å€™ï¼Œåº”è¯¥ä»Earliestå¼€å§‹æ¶ˆè´¹ï¼Œä¿è¯æ‰€æœ‰å¾®æœåŠ¡å†…å­˜ä¸­çš„æ¶ˆæ¯è§†å›¾ä¸€è‡´\nåŒä¸Šï¼Œéœ€è¦æ³¨æ„æ¶ˆè´¹ç»„çš„è€åŒ–\n\nä¸ºä»€ä¹ˆéœ€è¦æ¶ˆè´¹ç»„è€åŒ–ä½œä¸ºä¿åº•æ‰‹æ®µå› ä¸ºåœ¨æç«¯åœºæ™¯ä¸‹ï¼Œæ— è®ºæ˜¯gracefulçš„ä»£ç ï¼Œè¿˜æ˜¯ç›‘å¬killä¿¡å·çš„ä»£ç ï¼Œéƒ½ä¸èƒ½ä¿è¯ä»£ç ç™¾åˆ†ç™¾åœ°è¢«æ‰§è¡Œã€‚éœ€è¦å…œåº•ã€‚\nKafkaæ¶ˆè´¹ç»„è€åŒ–Kafkaé€šè¿‡offsets.retention.minuteså‚æ•°æ§åˆ¶æ¶ˆè´¹ç»„ä¸­offsetsä¿ç•™æ—¶é—´ï¼Œåœ¨æ­¤æ—¶é—´å†…å¦‚æœæ²¡æœ‰æäº¤offsetï¼Œoffsetså°†ä¼šè¢«åˆ é™¤ã€‚Kafkaåˆ¤å®šæ¶ˆæ¯ç»„ä¸­æ²¡æœ‰åœ¨çº¿çš„æ¶ˆè´¹è€…ï¼ˆå¦‚emptyçŠ¶æ€ï¼‰ï¼Œä¸”æ²¡æœ‰offsetsæ—¶ï¼Œå°†ä¼šåˆ é™¤æ­¤æ¶ˆè´¹ç»„ã€‚\nPulsaræ¶ˆè´¹ç»„è€åŒ–pulsarçš„æ¶ˆè´¹ç»„è€åŒ–ç­–ç•¥æ›´åŠ çµæ´»ï¼Œå¯ä»¥é…ç½®åˆ°namespaceçº§åˆ«ã€‚\nbin/pulsar-admin namespaces | grep expiration    get-subscription-expiration-time      Get subscription expiration time for       Usage: get-subscription-expiration-time [options] tenant/namespace    set-subscription-expiration-time      Set subscription expiration time for       Usage: set-subscription-expiration-time [options] tenant/namespace            Subscription expiration time in minutes    remove-subscription-expiration-time      Remove subscription expiration       Usage: remove-subscription-expiration-time [options] tenant/namespace\n\nè¿™é‡Œæ³¨æ„è¦åˆç†åœ°é…ç½®æ¶ˆè´¹ç»„çš„è€åŒ–æ—¶é—´ï¼Œåœ¨pulsarçš„å½“å‰ç‰ˆæœ¬ï¼ˆ2.11ç‰ˆæœ¬ï¼‰ä¸‹ï¼Œcatch upè¯»ï¼Œä¹Ÿå°±æ˜¯è¯´æ¶ˆè´¹ç»„å¹³æ—¶ç§¯å‹é‡ä¸å¤§ã€‚å¦‚æœå°†æ¶ˆè´¹ç»„çš„è€åŒ–æ—¶é—´é…ç½®å¤§äºç­‰äºæ¶ˆæ¯çš„è€åŒ–æ—¶é—´ï¼Œä¼šå‡ºç°æ¶ˆè´¹ç»„è€åŒ–ä¸äº†çš„ç°è±¡ã€‚\nå½“ç„¶ï¼Œç”±äºæ¶ˆè´¹ç»„å’Œæ¶ˆæ¯è€åŒ–éƒ½æ˜¯å®šæ—¶ä»»åŠ¡ï¼Œé¢„ä¼°æ—¶é—´æ—¶ï¼Œè¦è€ƒè™‘ä¸€å®šçš„bufferã€‚\nè¿™é‡Œè®©æˆ‘ä»¬ç¨ç¨diveä¸€ä¸‹åŸç†ï¼Œæ¶ˆè´¹ç»„çš„è€åŒ–æ˜¯é€šè¿‡åˆ¤æ–­Cursoræ¸¸æ ‡çš„LastActive timeæ¥åˆ¤æ–­èƒ½å¦è€åŒ–çš„ã€‚å¦‚æœè¯¥æ¶ˆè´¹ç»„çš„æ¸¸æ ‡ä½ç½®åˆ°è¾¾äº†æ¶ˆæ¯è€åŒ–åŒºåŸŸï¼Œè¢«è€åŒ–æ‰äº†ï¼Œæ¶ˆè´¹ç»„çš„æ¸¸æ ‡ä½ç½®å°±ä¼šå¼ºåˆ¶æ›´æ–°åˆ°ä¸€ä¸ªå¯ç”¨çš„ä½ç½®ï¼Œè¿™ä¸ªæ—¶å€™ä¼šæ›´æ–°æ¸¸æ ‡çš„LastActive timeåˆ°å½“å‰æ—¶é—´ï¼Œå‘¨è€Œå¤å§‹ï¼Œå¯¼è‡´æ¶ˆè´¹ç»„æ— æ³•è€åŒ–ã€‚ä¸¾ä¸ªğŸŒ°\nå‡è®¾æ¶ˆè´¹ç»„çš„è€åŒ–æ—¶é—´ä¸º4hï¼Œæ¶ˆæ¯çš„è€åŒ–æ—¶é—´ä¸º3hï¼Œå°±å¯èƒ½ä¼šå‘ç”Ÿè¿™æ ·çš„äº‹æƒ…\n\næ€»ç»“å¹¿æ’­æ¨¡å¼åœ¨å¾®æœåŠ¡æ¶æ„ä¸­èµ·åˆ°äº†é‡è¦çš„è§’è‰²ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦åœ¨å¾®æœåŠ¡å®ä¾‹ä¹‹é—´åŒæ­¥æ•°æ®çš„åœºæ™¯ä¸­ï¼Œå®ƒå…·æœ‰æ˜¾è‘—çš„ä¼˜åŠ¿ã€‚å®ƒèƒ½å¤Ÿå¸®åŠ©ç»´æŠ¤å†…å­˜æ•°æ®çš„ç¼“å­˜ä¸€è‡´æ€§ã€‚å¸Œæœ›æœ¬ç¯‡æ–‡ç« èƒ½æä¾›æ‚¨å…¨é¢çš„å¹¿æ’­æ¨¡å¼çš„çŸ¥è¯†ã€‚\n"},{"title":"æ‰“é€ å¯å•†ç”¨çš„Javaç¨‹åºä¹‹å¯ç»´æŠ¤æ€§","url":"/2023/06/15/%E6%89%93%E9%80%A0%E5%8F%AF%E5%95%86%E7%94%A8%E7%9A%84Java%E7%A8%8B%E5%BA%8F%E4%B9%8B%E5%8F%AF%E7%BB%B4%E6%8A%A4%E6%80%A7/","content":"åœ¨ä¸»å‡½æ•°ä¸­æ•è·æœªå¤„ç†çš„å¼‚å¸¸åœ¨ä¸»å‡½æ•°ä¸­æ•è·æœªå¤„ç†çš„å¼‚å¸¸ï¼Œé˜²æ­¢ç¨‹åºå´©æºƒï¼ŒåŒæ—¶è®°å½•æ—¥å¿—ï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜ã€‚\npublic class UncaughtExceptionHandle &#123;    public static void main(String[] args) &#123;        Thread.setDefaultUncaughtExceptionHandler((t, e) -&gt; log.error(&quot;Uncaught exception: &quot;, e));    &#125;&#125;\n"},{"title":"çº¿ç¨‹é”å¯¼è‡´çš„kafkaå®¢æˆ·ç«¯è¶…æ—¶é—®é¢˜","url":"/2023/07/08/%E7%BA%BF%E7%A8%8B%E9%94%81%E5%AF%BC%E8%87%B4%E7%9A%84kafka%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%B6%85%E6%97%B6%E9%97%AE%E9%A2%98/","content":"é—®é¢˜èƒŒæ™¯æœ‰ä¸€ä¸ªç¯å¢ƒçš„kafka clientå‘é€æ•°æ®æœ‰éƒ¨åˆ†è¶…æ—¶ï¼Œæ‹“æ‰‘å›¾ä¹Ÿéå¸¸ç®€å•\n\nå®šä½å†ç¨‹æˆ‘ä»¬å…ˆå¯¹å®¢æˆ·ç«¯çš„ç¯å¢ƒåŠJVMæƒ…å†µè¿›è¡Œäº†æ’æŸ¥ï¼Œä»JVMæ‰€åœ¨çš„è™šæ‹Ÿæœºåˆ°kafka serverçš„ç½‘ç»œæ­£å¸¸ï¼Œåƒåœ¾å›æ”¶ï¼ˆGCï¼‰æ—¶é—´ä¹Ÿåœ¨é¢„æœŸèŒƒå›´å†…ï¼Œæ²¡æœ‰å‡ºç°å¼‚å¸¸ã€‚\nç´§æ¥ç€ï¼Œæˆ‘ä»¬æŠŠç›®å…‰è½¬å‘äº†kafka æœåŠ¡å™¨ï¼Œè¿›è¡Œäº†ä¸€äº›åŸºç¡€çš„æ£€æŸ¥ï¼ŒåŒæ—¶ä¹ŸæŸ¥çœ‹äº†kafkaå¤„ç†è¯·æ±‚çš„è¶…æ—¶æ—¥å¿—ï¼Œå…¶ä¸­æˆ‘ä»¬å…³å¿ƒçš„metadataå’Œproduceè¯·æ±‚éƒ½æ²¡æœ‰è¶…æ—¶ã€‚\né—®é¢˜å°±æ­¤é™·å…¥äº†åƒµå±€ï¼Œè™½ç„¶ä¹Ÿæœåˆ°äº†ä¸€äº›kafka serverä¼šå¯¹è¿ä¸Šæ¥çš„clientåè§£å¯¼è‡´è¶…æ—¶çš„é—®é¢˜ï¼ˆ https://github.com/apache/kafka/pull/10059ï¼‰ï¼Œä½†é€šè¿‡ä¸€äº›ç®€å•çš„åˆ†æï¼Œæˆ‘ä»¬ç¡®å®šè¿™å¹¶éæ˜¯é—®é¢˜æ‰€åœ¨ã€‚\nåŒæ—¶ï¼Œæˆ‘ä»¬åœ¨ç¯å¢ƒä¸Šä¹Ÿå‘ç°ä¸€äº›å¼‚å¸¸æƒ…å†µï¼Œå½“æ—¶è§‰å¾—ä¸æ˜¯æ ¸å¿ƒé—®é¢˜&#x2F;è§£é‡Šä¸é€šï¼Œæ²¡æœ‰æ·±å…¥å»çœ‹\n\né—®é¢˜JVMçº¿ç¨‹æ•°è¾ƒé«˜ï¼Œå·²ç»è¶…è¿‡10000ï¼Œè¿™ä¸ªçº¿ç¨‹æ•°é‡è™½ç„¶ç¡®å®è¾ƒé«˜ï¼Œä½†å¹¶ä¸ä¼šå¯¹1ä¸ª4Uçš„å®¹å™¨äº§ç”Ÿä»€ä¹ˆå®è´¨æ€§çš„å½±å“ã€‚\nè´Ÿè´£æŒ‡æ ‡ä¸ŠæŠ¥çš„çº¿ç¨‹CPUè¾ƒé«˜ï¼Œå¤§çº¦å ç”¨äº†1&#x2F;4 ~ 1&#x2F;2 çš„CPUæ ¸ï¼Œè¿™ä¸ªå¯¹äº4Uçš„å®¹å™¨æ¥çœ‹é—®é¢˜ä¹Ÿä¸å¤§\n\nå½“æ’æŸ¥é™·å…¥åƒµå±€ï¼Œæˆ‘ä»¬å¼€å§‹è€ƒè™‘å…¶ä»–å¯èƒ½çš„è°ƒæŸ¥æ‰‹æ®µã€‚æˆ‘ä»¬å°è¯•æŠ“åŒ…æ¥æ‰¾çº¿ç´¢ï¼Œè¿™é‡Œçš„æŠ“åŒ…æ˜¯SASLé‰´æƒ+SSLåŠ å¯†çš„ï¼Œéå¸¸éš¾è¯»ï¼Œåªèƒ½é é•¿åº¦å’Œå“åº”æ—¶é—´å‹‰å¼ºæ¥æ¨æ–­æŠ¥æ–‡çš„å†…å®¹ã€‚\nåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªéå¸¸é‡è¦çš„çº¿ç´¢ï¼Œå®¢æˆ·ç«¯ç«Ÿç„¶å‘èµ·äº†è¶…æ—¶æ–­é“¾ï¼Œå¹¶ä¸”è¶…æ—¶çš„é‚£æ¡æ¶ˆæ¯ï¼Œå®é™…æœåŠ¡ç«¯æ˜¯æœ‰å“åº”å›å¤çš„ã€‚\néšåæˆ‘ä»¬å°†kafka clientçš„traceçº§åˆ«æ—¥å¿—æ‰“å¼€ï¼Œè¿™é‡Œä¸ç¦æ„Ÿå¹kafka clientæ—¥å¿—æ‰“çš„ç›¸å¯¹è¾ƒå°‘ï¼Œå‘ç°çš„ç¡®æœ‰log.debug(â€œDisconnecting from node {} due to request timeout.â€, nodeId);çš„æ—¥å¿—æ‰“å°ã€‚\nä¸ç½‘ç»œç›¸å…³çš„æµç¨‹ï¼š\ntry &#123;    // è¿™é‡Œå‘å‡ºäº†è¯·æ±‚    client.send(request, time.milliseconds());    while (client.active()) &#123;        List&lt;ClientResponse&gt; responses = client.poll(Long.MAX_VALUE, time.milliseconds());        for (ClientResponse response : responses) &#123;            if (response.requestHeader().correlationId() == request.correlationId()) &#123;                if (response.wasDisconnected()) &#123;                    throw new IOException(&quot;Connection to &quot; + response.destination() + &quot; was disconnected before the response was read&quot;);                &#125;                if (response.versionMismatch() != null) &#123;                    throw response.versionMismatch();                &#125;                return response;            &#125;        &#125;    &#125;    throw new IOException(&quot;Client was shutdown before response was read&quot;);&#125; catch (DisconnectException e) &#123;    if (client.active())        throw e;    else        throw new IOException(&quot;Client was shutdown before response was read&quot;);&#125;\n\nè¿™ä¸ªpollæ–¹æ³•ï¼Œä¸æ˜¯ç®€å•çš„pollæ–¹æ³•ï¼Œè€Œåœ¨pollæ–¹æ³•ä¸­ä¼šè¿›è¡Œè¶…æ—¶åˆ¤æ–­ï¼ŒæŸ¥çœ‹pollæ–¹æ³•ä¸­è°ƒç”¨çš„handleTimedOutRequestsæ–¹æ³•\n@Overridepublic List&lt;ClientResponse&gt; poll(long timeout, long now) &#123;    ensureActive();    if (!abortedSends.isEmpty()) &#123;        // If there are aborted sends because of unsupported version exceptions or disconnects,        // handle them immediately without waiting for Selector#poll.        List&lt;ClientResponse&gt; responses = new ArrayList&lt;&gt;();        handleAbortedSends(responses);        completeResponses(responses);        return responses;    &#125;    long metadataTimeout = metadataUpdater.maybeUpdate(now);    try &#123;        this.selector.poll(Utils.min(timeout, metadataTimeout, defaultRequestTimeoutMs));    &#125; catch (IOException e) &#123;        log.error(&quot;Unexpected error during I/O&quot;, e);    &#125;    // process completed actions    long updatedNow = this.time.milliseconds();    List&lt;ClientResponse&gt; responses = new ArrayList&lt;&gt;();    handleCompletedSends(responses, updatedNow);    handleCompletedReceives(responses, updatedNow);    handleDisconnections(responses, updatedNow);    handleConnections();    handleInitiateApiVersionRequests(updatedNow);    // å…³é”®çš„è¶…æ—¶åˆ¤æ–­    handleTimedOutRequests(responses, updatedNow);    completeResponses(responses);    return responses;&#125;\n\nç”±æ­¤æˆ‘ä»¬æ¨æ–­ï¼Œé—®é¢˜å¯èƒ½åœ¨äºå®¢æˆ·ç«¯hangä½äº†ä¸€æ®µæ—¶é—´ï¼Œä»è€Œå¯¼è‡´è¶…æ—¶æ–­é“¾ã€‚æˆ‘ä»¬é€šè¿‡å·¥å…·Arthasæ·±å…¥è·Ÿè¸ªäº†Kafkaçš„ç›¸å…³ä»£ç ï¼Œç”šè‡³å‘ç°ä¸€äº›ç®€å•çš„æ“ä½œï¼ˆå¦‚A.fieldï¼‰ä¹Ÿéœ€è¦æ•°ç§’çš„æ—¶é—´ã€‚è¿™è¿›ä¸€æ­¥ç¡®è®¤äº†æˆ‘ä»¬çš„çŒœæƒ³ï¼šé—®é¢˜å¯èƒ½å‡ºåœ¨JVMã€‚JVMå¯èƒ½åœ¨æŸä¸ªæ—¶åˆ»å‡ºç°é—®é¢˜ï¼Œå¯¼è‡´ç³»ç»Ÿhangä½ï¼Œä½†è¿™å¹¶éç”±GCå¼•èµ·ã€‚\n\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åˆæ£€æŸ¥äº†ç›‘æ§çº¿ç¨‹CPUè¾ƒé«˜çš„é—®é¢˜ã€‚æˆ‘ä»¬å‘ç°çº¿ç¨‹çš„æ‰§è¡Œçƒ­ç‚¹æ˜¯ä»â€sun.management.ThreadImplâ€ä¸­çš„â€getThreadInfoâ€æ–¹æ³•ã€‚\n&quot;metrics-1@746&quot; prio=5 tid=0xf nid=NA runnable  java.lang.Thread.State: RUNNABLE    at sun.management.ThreadImpl.getThreadInfo(Native Method)\t  at sun.management.ThreadImpl.getThreadInfo(ThreadImpl.java:185)\t  at sun.management.ThreadImpl.getThreadInfo(ThreadImpl.java:149)\n\nè¿›ä¸€æ­¥å‘ç°ï¼Œåœ¨æŸäº›ç‰ˆæœ¬çš„JDK8ä¸­ï¼Œè¯»å–çº¿ç¨‹ä¿¡æ¯æ˜¯éœ€è¦åŠ é”çš„ã€‚\nè‡³æ­¤ï¼Œé—®é¢˜çš„æ ¹æºå·²ç»æ¸…æ™°æ˜äº†ï¼šè¿‡é«˜çš„çº¿ç¨‹æ•°ä»¥åŠçº¿ç¨‹ç›‘æ§æ—¶JVMå…¨å±€é”çš„å­˜åœ¨å¯¼è‡´äº†è¿™ä¸ªé—®é¢˜ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„demoæ¥å¤ç°è¿™ä¸ªé—®é¢˜\nimport java.lang.management.ManagementFactory;import java.lang.management.ThreadInfo;import java.lang.management.ThreadMXBean;import java.util.concurrent.Executors;import java.util.concurrent.ScheduledExecutorService;import java.util.concurrent.TimeUnit;public class ThreadLockSimple &#123;    public static void main(String[] args) &#123;        for (int i = 0; i &lt; 15_000; i++) &#123;            new Thread(new Runnable() &#123;                @Override                public void run() &#123;                    try &#123;                        Thread.sleep(200_000);                    &#125; catch (InterruptedException e) &#123;                        throw new RuntimeException(e);                    &#125;                &#125;            &#125;).start();        &#125;        ScheduledExecutorService executorService = Executors.newSingleThreadScheduledExecutor();        executorService.scheduleAtFixedRate(new Runnable() &#123;            @Override            public void run() &#123;                System.out.println(&quot;take &quot; + &quot; &quot; + System.currentTimeMillis());            &#125;        &#125;, 1, 1, TimeUnit.SECONDS);        ThreadMXBean threadMXBean = ManagementFactory.getThreadMXBean();        ScheduledExecutorService metricsService = Executors.newSingleThreadScheduledExecutor();        metricsService.scheduleAtFixedRate(new Runnable() &#123;            @Override            public void run() &#123;                long start = System.currentTimeMillis();                ThreadInfo[] threadInfoList = threadMXBean.getThreadInfo(threadMXBean.getAllThreadIds());                System.out.println(&quot;threads count &quot; + threadInfoList.length + &quot; cost :&quot; + (System.currentTimeMillis() - start));            &#125;        &#125;, 1, 1, TimeUnit.SECONDS);    &#125;&#125;\n\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹å‡ ä¸ªå¯èƒ½çš„æ–¹æ¡ˆï¼š\n\nå°†ä¸åˆç†çš„çº¿ç¨‹æ•°å¾€ä¸‹é™ï¼Œå¯èƒ½å­˜åœ¨çº¿ç¨‹æ³„éœ²çš„åœºæ™¯\nå‡çº§jdkåˆ°jdk11æˆ–è€…jdk17ï¼ˆæ¨èï¼‰\nå°†Threadç›¸å…³çš„ç›‘æ§ä¸´æ—¶å…³é—­\n\nè¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆåº”æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œé€‰æ‹©ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚\n","tags":["Kafka"]},{"title":"ç½‘ç»œé€šä¿¡è¶…æ—¶ä¹‹åè¯¥ä¸è¯¥é‡å¯å®¢æˆ·ç«¯","url":"/2023/07/08/%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E8%B6%85%E6%97%B6%E4%B9%8B%E5%90%8E%E8%AF%A5%E4%B8%8D%E8%AF%A5%E9%87%8D%E5%90%AF%E5%AE%A2%E6%88%B7%E7%AB%AF/","content":"æˆ‘å†™è¿™ç¯‡æ–‡ç« æ¥è®ºè¯â€œè¶…æ—¶ä¹‹åè¦ä¸è¦é‡å¯å®¢æˆ·ç«¯â€ã€â€œå¦‚ä½•é‡å¯å®¢æˆ·ç«¯â€ã€‚ç®€è€Œè¨€ä¹‹ï¼Œé‡å¯å®¢æˆ·ç«¯è¿˜æ˜¯ä¸ºäº†è®©ç³»ç»Ÿèƒ½å¤Ÿè¾¾åˆ°è‡ªæ„ˆï¼Œæ˜¯æ¯”è¾ƒé«˜çš„å¯é æ€§è¦æ±‚ã€‚å¦‚æœä½ çš„è½¯ä»¶æ²¡æœ‰è¿™ä¹ˆé«˜çš„å¯é æ€§è¦æ±‚ï¼Œåƒæ˜¯äººæœºäº¤äº’ç¨‹åºç­‰å¯¹å¯é æ€§è¦æ±‚è¾ƒä½çš„åœºæ™¯ï¼Œå¯ä»¥é€‰æ‹©ä¸è€ƒè™‘è¿™ä¸ªåŠŸèƒ½ã€‚æ¯•ç«Ÿå®ç°è¿™ä¸ªåŠŸèƒ½çš„æ—¶é—´è‡³å°‘å¤Ÿ300å€ä½ é‡æ–°ç‚¹å‡»æŒ‰é’®&#x2F;é‡å¯çš„æ—¶é—´äº†ã€‚\nå¦‚æœæ˜¯ä¸€äº›ä¸²å£åè®®ï¼Œé€šè¿‡ä¼ è¾“çš„é—´éš™æ¥åˆ¤æ–­æŠ¥æ–‡çš„é—´éš”ï¼Œæ¯”å¦‚modbusåè®®ï¼Œ3.5ä¸ªæ—¶é—´å†…ä¸å‘é€ï¼Œå°±è®¡ç®—åšä¸€ä¸ªåè®®æŠ¥æ–‡çš„å¼€å§‹ï¼Œé‚£ä¹ˆæ•…éšœæ—¶çš„æŠ¥æ–‡æ¯«æ— ç–‘é—®ä¼šå¤„ç†å¤±è´¥ï¼ˆå› ä¸ºå­˜åœ¨CRCæ ¡éªŒï¼Œå¥‡å¶æ ¡éªŒç­‰ï¼‰ã€‚ç­‰å¾…æ•…éšœç»“æŸï¼Œåˆ3.5ä¸ªæ—¶é—´åï¼Œå°±ä¼šæ¢å¤æ­£å¸¸ã€‚\nå¦‚æœèƒ½ç¡®ä¿ç½‘ç»œé€šä¿¡æŠ¥æ–‡ä¸ä¼šé­åˆ°ç¯¡æ”¹ã€ä¹Ÿæ²¡æœ‰å®‡å®™å°„çº¿&#x2F;å¤ªé˜³é»‘å­ä¿®æ”¹ä½ çš„æ¯”ç‰¹ä½çš„åœºæ™¯ä¸‹ï¼Œç¬”è€…è®¤ä¸ºæ²¡æœ‰ç‰¹åˆ«å¤§çš„å¿…è¦å¯¹å®¢æˆ·ç«¯è¿›è¡Œé‡å¯æ“ä½œï¼Œå› ä¸ºä¸è§å¾—é‡å¯åå°±æ¯”ä¹‹å‰æ›´å¥½ï¼Œè¿™ç§è¶…æ—¶é€šå¸¸æ˜¯ç”±æœåŠ¡ç«¯å¤„ç†æ—¶é—´é•¿å¯¼è‡´çš„ã€‚æ²¡åšåˆ°å»ºé“¾é™åˆ¶çš„æƒ…å†µä¸‹ï¼Œè´¸ç„¶é‡å¯ï¼Œè¿˜å¯èƒ½ä¼šå¼•èµ·å»ºé“¾çš„æ³¢å³°ã€‚\nä½†æ˜¯ï¼Œåœ¨å®é™…å¤æ‚çš„ç½‘ç»œç¯å¢ƒä¸‹ï¼Œå¦‚ç½‘ç»œæŠ¥æ–‡é­åˆ°ç¯¡æ”¹ã€éƒ¨åˆ†å­—èŠ‚ä¸¢å¤±ç­‰çš„æƒ…å†µä¸‹ï¼Œä¸€åˆ‡å°±å¤§ä¸ä¸€æ ·äº†ï¼Œä¸é‡å¯å®¢æˆ·ç«¯å°±æ— æ³•è‡ªæ„ˆã€‚è¿™å…¶ä¸­çš„å…³é”®åœ¨äºï¼Œåˆ‡åˆ†æŠ¥æ–‡æ˜¯å¦æ­£ç¡®ã€‚\næ¯”å¦‚åŸºäºTCPçš„ç½‘ç»œåè®®ï¼Œè¿™ä¹Ÿæ˜¯æœ¬æ–‡é‡ç‚¹è®¨è®ºçš„åœºæ™¯ï¼Œå‡è®¾åº”ç”¨åè®®é‡‡ç”¨æœ€å¸¸è§çš„LengthBasedFrameåˆ†åŒ…æ–¹å¼ï¼Œè¿™ç§åè®®ï¼Œé€šå¸¸æ ¹æ®å‰0~4ä¸ªå­—èŠ‚æ¥åˆ¤æ–­åè®®çš„æ€»é•¿åº¦ï¼Œæ¯”å¦‚å‰é¢çš„å­—èŠ‚æ˜¯00000014ï¼Œé‚£è¿™ä¸ªæŠ¥æ–‡é•¿åº¦å°±æ˜¯1*16 + 4 = 20é•¿åº¦ã€‚è¿™ç§æ—¶å€™ï¼Œä¸€æ—¦å‘ç”Ÿäº†æŠ¥æ–‡ç¯¡æ”¹&#x2F;ä¸¢åŒ…ï¼Œä¼šå¯¼è‡´é€šä¿¡ç«¯è®¡ç®—æŠ¥æ–‡é•¿åº¦å‡ºé”™ï¼Œä¸€ç›´åœ¨å‚»ç­‰ï¼Œæ— æ³•è‡ªæ„ˆã€‚\næ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ä¸€æ—¦å‘ç”Ÿç¯¡æ”¹ï¼Œå°†4ç¯¡æ”¹5ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´å®¢æˆ·ç«¯&#x2F;æœåŠ¡å™¨ä¸€ç›´åœ¨ç­‰å¾…ä¸å­˜åœ¨çš„ç¬¬21ä¸ªå­—èŠ‚ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¸åšè¶…æ—¶é‡å»ºï¼Œé‚£ä¹ˆè¿™æ¡é“¾è·¯å°±ä¼šä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ï¼Œæ— æ³•è‡ªæ„ˆã€‚\nç»¼ä¸Šæ‰€è¿°ï¼Œå®é™…å¤æ‚çš„ç½‘ç»œç¯å¢ƒä¸‹å‡ºç°é€šä¿¡è¶…æ—¶ï¼Œè¿™æ¡é“¾è·¯å¯èƒ½ä¼šæ— æ³•è‡ªæ„ˆã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œç¬”è€…æ¨èå¯¹é’ˆå¯¹tcpé“¾è·¯åšè¶…æ—¶é‡å»ºï¼Œä¸šå†…çš„ä¸€äº›ä¾‹å­åƒæ˜¯ï¼šbookkeeper clientæ²¡æœ‰åšï¼Œkafka clientåšäº†ã€‚è‡³äºé‡å»ºçš„è§¦å‘æ¡ä»¶ï¼Œæ¯”å¦‚ä¸€æ¬¡è¶…æ—¶å°±é‡å»ºã€å¤šæ¬¡è¶…æ—¶ä¹‹åæ‰é‡å»ºã€ä»…å½“å¿ƒè·³æŠ¥æ–‡è¶…æ—¶æ‰é‡å»ºï¼Œè¿™äº›å°±äº¤ç»™è¯»è€…è‡ªå·±æŠŠæ¡äº†ã€‚å¦‚æœåŒºåˆ«ä¸å¤§ï¼Œç¬”è€…å€¾å‘äºä¸€æ¬¡è¶…æ—¶å°±é‡å»ºï¼Œé€»è¾‘ç®€å•æ¸…æ™°ã€‚\n"},{"title":"è½¯ä»¶åº”è¯¥ä»¥æ ‡å‡†çš„æ ¼å¼æ¥äº¤ä»˜","url":"/2025/09/22/%E8%BD%AF%E4%BB%B6%E5%BA%94%E8%AF%A5%E4%BB%A5%E6%A0%87%E5%87%86%E7%9A%84%E6%A0%BC%E5%BC%8F%E6%9D%A5%E4%BA%A4%E4%BB%98/","content":"ä»¤äººæ·±æ€çš„ç»å†æ›¾ç»å†è¿‡è¿™æ ·çš„äº‹æƒ…ï¼Œå¹³å°ä¾§è¦æ±‚åº”ç”¨æä¾›æ»¡è¶³å¹³å°ç‰¹æœ‰æ ¼å¼çš„äº¤ä»˜ä»¶ï¼Œç»è¿‡å¤šæ¬¡åå•†ï¼Œæœ€ç»ˆè¿˜æ˜¯åº”ç”¨ä¾§ä¸å¹³å°ä¾§ä¸€èµ·å¼€ä¼šï¼Œç”±å¹³å°ä¾§å¸®åŠ©åº”ç”¨ä¾§è¾“å‡ºã€‚\nå¦ä¸€ä»¶äº‹ï¼ŒKubernetes Yamlä»¥å…¶ç‹¬ç‰¹ã€å¼ºå¤§çš„åˆå¹¶å±æ€§èƒ½åŠ›é—»åäºæ±Ÿæ¹–ã€‚åº”ç”¨ä¾§å¯¹Kubernetes Yamlä¸ç†Ÿæ‚‰ï¼Œæ–°æ‰‹æƒ³è¦æŠŠç¯å¢ƒä¸Šçš„Yamlå¯¼å‡ºç›´æ¥ä½œä¸ºæ ‡å‡†äº¤ä»˜ä»¶ï¼Œè™½ç„¶ä¹Ÿè¡Œï¼Œä½†æ˜¯åŒ…å«äº†å¾ˆå¤šå™ªéŸ³ï¼Œç¯å¢ƒä¸Šçš„idã€ç¯å¢ƒä¸Šçš„annotationã€æ—¶é—´æˆ³ç­‰ç­‰ã€‚\nç§æœ‰åŒ–æ ¼å¼çš„äº¤ä»˜å›°å¢ƒè¶Šæ¥è¶Šå¤šçš„è½¯ä»¶å°†è‡ªå·±å®šä½ä¸ºâ€å¹³å°â€ï¼Œæ— è®ºæ˜¯å¾®ä¿¡ã€é£ä¹¦è¿™æ ·çš„å›½æ°‘åº”ç”¨ï¼Œè¿˜æ˜¯å„ç±»ä¼ä¸šçº§è½¯ä»¶ã€‚ä½†å¹³å°äº¤ä»˜çš„è¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªæ™®éå­˜åœ¨çš„é—®é¢˜æ˜¯ï¼šè®¸å¤šå¹³å°è¦æ±‚åˆä½œä¼™ä¼´æˆ–ç¬¬ä¸‰æ–¹å¼€å‘è€…ä½¿ç”¨å…¶ç§æœ‰åŒ–çš„äº¤ä»˜æ ¼å¼ã€‚è¿™ç§ç§æœ‰åŒ–æ ¼å¼å¾€å¾€å­˜åœ¨è¯¸å¤šé—®é¢˜ï¼š\n\nå­¦ä¹ æˆæœ¬é«˜ï¼Œéš¾ä»¥æŒæ¡ã€‚\næ–‡æ¡£ä¸å®Œå–„ï¼Œä¾èµ–å¹³å°æ–¹æ”¯æŒã€‚\nè¿ç§»å›°éš¾ï¼Œå½¢æˆä¾›åº”å•†é”å®šã€‚\næœ€ç»ˆå¾€å¾€ä»éœ€å¹³å°æ–¹æŠ•å…¥äººåŠ›ååŠ©ã€‚\n\nè½¯ä»¶äº¤ä»˜åº”è¯¥æ ‡å‡†åŒ–è½¯ä»¶äº¤ä»˜åº”è¯¥ä½¿ç”¨æ ‡å‡†çš„æ ¼å¼ï¼Œè¿™æœ‰åŠ©äºé™ä½åˆä½œä¼™ä¼´çš„æ¥å…¥æˆæœ¬ï¼Œæé«˜è‡ªèº«çš„å¯æ‰©å±•æ€§ï¼Œå°¤å…¶åœ¨AIè¾…åŠ©ç ”å‘çš„ç°çŠ¶ä¸‹ï¼Œé‡‡ç”¨æ ‡å‡†çš„æ ¼å¼æ›´æœ‰åˆ©äºAIç†è§£å’Œç”Ÿæˆä»£ç ã€‚\n\n\n\näº¤ä»˜ä»¶\næ ‡å‡†æ ¼å¼\nä½¿ç”¨åœºæ™¯\n\n\n\nJavaåº“\nJaråŒ…\nä½œä¸ºä¾èµ–åº“è¢«å…¶ä»–Javaé¡¹ç›®å¼•ç”¨å’Œé›†æˆï¼Œéœ€è¦å‘å¸ƒåˆ°Mavenä»“åº“ã€‚\n\n\nåº”ç”¨é•œåƒ\næ ‡å‡†é•œåƒåŒ…\nä»¥å®¹å™¨æ–¹å¼äº¤ä»˜ï¼Œç¡®ä¿è¿è¡Œçš„ä¸€è‡´æ€§ã€‚ï¼ˆä½†å¦‚x86ã€armv8ã€armv7ï¼‰çš„å·®å¼‚ä¾ç„¶å­˜åœ¨ã€‚\n\n\nåº”ç”¨éƒ¨ç½²ï¼ˆIå±‚èµ„æºå·²å…·å¤‡ï¼‰\nhelmã€docker compose\nå•†ç”¨åœºæ™¯å¤šç”¨HelmåŒ…ï¼Œå•æœºä¼ªé›†ç¾¤&#x2F;ç»„åˆæ–¹å¼å¤šç”¨docker composeã€‚\n\n\nåº”ç”¨éƒ¨ç½²åŠIå±‚èµ„æºåˆ›å»º\nTerraform\néœ€è¦äº¤ä»˜åº•å±‚åŸºç¡€è®¾æ–½æˆ–äº‘æœåŠ¡çš„åœºæ™¯ï¼Œå¦‚æ•´ä¸ªåº”ç”¨è¿è¡Œç¯å¢ƒã€‚\n\n\nå¦‚æœå®åœ¨è¦ä½¿ç”¨ç§æœ‰çš„æ ¼å¼ï¼Œå¯ä»¥å¯¹æ ‡å‡†æ ¼å¼åšä¸€äº›è£å‰ª&#x2F;æ‰©å±•ï¼ˆKubernetesçš„annotationï¼‰ï¼Œå°†æ ‡å‡†æ ¼å¼è½¬åŒ–åˆ°ç§æœ‰æ ¼å¼ã€‚\n"}]